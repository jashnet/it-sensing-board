name: ğŸŒ… Daily Morning Sensing Batch

on:
  schedule:
    - cron: '0 22 * * *'
  workflow_dispatch:

concurrency:
  group: morning-sensing
  cancel-in-progress: true

jobs:
  run-batch:
    runs-on: ubuntu-latest
    permissions:
      contents: write

    steps:
      - name: ì €ì¥ì†Œ ì²´í¬ì•„ì›ƒ
        uses: actions/checkout@v4
        with:
          ref: main

      - name: íŒŒì´ì¬ í™˜ê²½ ì„¤ì •
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'

      - name: í•„ìˆ˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜
        run: |
          pip install feedparser google-genai beautifulsoup4 deep-translator

      - name: ëª¨ë‹ ì„¼ì‹± ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ (batch.py)
        env:
          GEMINI_API_KEY: ${{ secrets.GEMINI_API_KEY }}
        run: python batch.py

      # ğŸ’¡ [ì§„ì§œ ìµœì¢… ë³´ìŠ¤ ê²©íŒŒ] ê¸¸ê³  ì—ëŸ¬ ë‚˜ë˜ ìˆ˜ë™ Git ëª…ë ¹ì–´ë“¤ì„ ì „ë¶€ ì§€ìš°ê³ , ë¬´ì ì˜ ìë™ ì»¤ë°‹ ì•¡ì…˜ í”ŒëŸ¬ê·¸ì¸ì„ ë„ì…í•©ë‹ˆë‹¤.
      - name: ğŸš€ ê¹ƒí—ˆë¸Œ ìë™ ì €ì¥ ë° ì¶©ëŒ ë°©ì§€ í”ŒëŸ¬ê·¸ì¸ ì‹¤í–‰
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          commit_message: "ğŸ¤– [Automated] Update Morning Sensing Data"
          branch: main
          file_pattern: 'today_news.json archive/*.json'
